<!DOCTYPE html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/atom+xml title="RSS Feed" href=https://brianvanburken.nl/feed.xml><title>Manually editing chunks in git add --patch | Brian van Burken</title><meta property=og:title content="Manually editing chunks in git add --patch"><meta name=description content="Git allows to stage smaller chunks of code for creating more atomic commits."><meta property=og:description content="Git allows to stage smaller chunks of code for creating more atomic commits."><meta property=og:type content=article><meta property=og:url content=https:&#x2F;&#x2F;brianvanburken.nl&#x2F;git-add-patch-split-chunks&#x2F;><meta property=og:site_name content="Brian van Burken"><link rel=canonical href=https:&#x2F;&#x2F;brianvanburken.nl&#x2F;git-add-patch-split-chunks&#x2F;><meta property=article:published_time content=2023-01-04T00:00:00+00:00><style>html{color:#fff;background:#0b0e14}@media (prefers-color-scheme:light){html{color:#0b0e14;background:#fff}}body{font-family:"Avenir Next","Open Sans",Helvetica,sans-serif;font-size:1.125rem;max-width:70ch;margin:1.5rem auto;padding:0 1.5rem}article,code,footer,h1,p,pre{margin:1.5rem 0;line-height:1.5rem}h1{font-size:2.5rem;line-height:3rem}p{text-align:justify}img{max-width:100%}a,a code{color:#fa3}a:visited{color:#ff9500}a:focus,a:hover{color:#ffbf66}footer{border-top:1px solid #bfbdb6;padding-top:1.5rem}code,pre{font-size:.875rem;word-spacing:normal;word-break:normal;word-wrap:normal;hyphens:none;color:#bfbdb6;background:#0b0e14;border-radius:.375rem}pre{overflow:auto;padding:1.5rem}p code{line-height:1;outline:3px solid #0b0e14;margin:0 2px}.c{color:#bfbdb6}.b{color:#c594c5}.d{color:#f26d78}.e{color:#70bf56}</style><p><a href=/ title="Overview of all my writings">Writings</a> | <a href=https://github.com/brianvanburken title="Visit my GitHub profile" target=_blank rel="noopener noreferrer">GitHub</a> | <a href=https://linkedin.com/in/brianvanburken title="Visit my LinkedIn profile" target=_blank rel="noopener noreferrer">LinkedIn</a><article itemscope itemtype=http://schema.org/BlogPosting><h1 itemprop="name headline">Manually editing chunks in git add --patch</h1><section itemprop=articleBody><p>Using <code>git add --patch</code>, git can stage smaller chunks of code for creating more atomic commits. The interactive mode provides chunks, and each can be staged using <code>y</code> or rejected using <code>n</code>. But sometimes, a more granular chunk is needed, and that is where <code>s</code> and <code>e</code> come into play. Where <code>s</code> tries to split it into smaller chunks, it might not always work wanted. You can then use <code>e</code> to <a rel="noopener nofollow noreferrer external" target=_blank href=https://git-scm.com/docs/git-add#_editing_patches>manually edit a patch</a>.<p>The desired change in the following example would be only to commit changes around variable <code>z</code>:<pre><code><span class=a><span class=b>--- a/main.rs</span></span>
<span class=a><span class=b>+++ b/main.rs</span></span>
<span class=a><span class=b>@@ -1,5 +1,5 @@</span></span>
<span class=a><span class=c> fn main() {</span></span>
<span class=a><span class=c>     let x = 5;</span></span>
<span class=a><span class=d>-    let y = 6;</span></span>
<span class=a><span class=d>-    let z = 7;</span></span>
<span class=a><span class=e>+    let y = 7;</span></span>
<span class=a><span class=e>+    let z = 8;</span></span>
<span class=a><span class=c>     println!("{} {} {}", x, y, z);</span></span>
<span class=a><span class=c> }</span></span>
</code></pre><p>We can use the <code>e</code> command to edit the chunk in a text editor manually. To only commit the changes for variable <code>z</code>, we need to remove the line <code>+ let y = 7;</code> and change the <code>-</code> before <code>let y = 6</code> into a space <code></code>. The patch should then look like this:<pre><code><span class=a><span class=c> fn main() {</span></span>
<span class=a><span class=c>     let x = 5;</span></span>
<span class=a><span class=c>     let y = 6;</span></span>
<span class=a><span class=d>-    let z = 7;</span></span>
<span class=a><span class=e>+    let z = 8;</span></span>
<span class=a><span class=c>     println!("{} {} {}", x, y, z);</span></span>
<span class=a><span class=c> }</span></span>
</code></pre><p>After saving and closing the editor, git will stage the modified patch, allowing you to create a commit with only the changes to variable <code>z</code>.</section><footer>Published on <time datetime=2023-01-04T00:00:00 itemprop=datePublished>2023-01-04</time><br>Tags: <a href=/tags/#git title="See all posts for Git">Git</a><br>Source <a href=https:&#x2F;&#x2F;github.com&#x2F;brianvanburken&#x2F;brianvanburken.github.io&#x2F;tree&#x2F;master&#x2F;content/git-add-patch-split-chunks.md target=_blank rel="noopener noreferrer" title="View post source on Github">on Github</a></footer></article><script data-goatcounter=https://brianvanburken.goatcounter.com/count async src=https://gc.zgo.at/count.js></script><noscript><img src="https://brianvanburken.goatcounter.com/count?p=/git-add-patch-split-chunks/"></noscript>